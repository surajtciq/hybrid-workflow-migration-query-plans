{
  "taskList": [
    "-- TASK 1 :: incrementality_python_generic : Non-SQL Module or Empty SQL Module",
    "-- TASK 2 :: incrementality_sb_python_generic : Non-SQL Module or Empty SQL Module",
    "-- TASK 3 :: sb_incrementality_report_final_generic : DROP TABLE IF EXISTS CLIENT_VIEW_CATALOG.temp_ccp_253.e0__sb_incrementality_report_final_generic",
    "-- TASK 4 :: sb_incrementality_report_final_generic : CREATE TABLE CLIENT_VIEW_CATALOG.temp_ccp_253.e0__sb_incrementality_report_final_generic using delta TBLPROPERTIES ('delta.feature.allowColumnDefaults'='supported') AS SELECT * FROM CLIENT_VIEW_CATALOG.temp_ccp_253.e0__incrementality_sb_python_generic WHERE report_type IN ('search', 'campaign', 'sku')",
    "-- TASK 5 :: temp_incrementality_report_generic : DROP TABLE IF EXISTS CLIENT_VIEW_CATALOG.temp_ccp_253.e0__temp_incrementality_report_generic",
    "-- TASK 6 :: temp_incrementality_report_generic : CREATE TABLE IF NOT EXISTS CLIENT_VIEW_CATALOG.temp_ccp_253.e0__temp_incrementality_report_generic (CLIENT_ID DECIMAL (18, 0), SEARCH STRING, PLACEMENT STRING, KEYWORD_TYPE STRING, REPORT_DATE DATE, CREATION_DATE TIMESTAMP, CAMPAIGN_ID STRING, CAMPAIGN_NAME STRING, PORTFOLIO_ID DECIMAL (18, 0), PORTFOLIO_NAME STRING, PROFILE_ID DECIMAL (18, 0), PROFILE_NAME STRING, CAMPAIGN_TYPE STRING, TARGETING_TYPE STRING, REPORT_TYPE STRING, REPORT_CALCULATION_TYPE STRING, TOTAL_SPONSORED_POSITIONS DECIMAL (18, 0), TOTAL_SPONSORED_WEIGHT DECIMAL (18, 0), CLIENT_SPONSORED_POSITIONS DECIMAL (18, 0), CLIENT_SPONSORED_WEIGHT DECIMAL (18, 0), CLIENT_ORGANIC_POSITIONS DECIMAL (18, 0), CLIENT_ORGANIC_WEIGHT DECIMAL (18, 0), CLICKS DECIMAL (18, 0), IMPRESSIONS DECIMAL (18, 0), COST DECIMAL (18, 2), ATTRIBUTEDSALES14D DECIMAL (18, 2), ROAS DECIMAL (18, 2), INCREMENTAL_FRACTION DECIMAL (18, 2), INCREMENTAL_FRACTION_BAND STRING, INCREMENTAL_SALES DECIMAL (18, 2), IROAS DECIMAL (18, 2), COVERAGE DECIMAL (18, 2), COVERAGE_TYPE STRING, CAMPAIGN_NAME_TOP_1 STRING, CAMPAIGN_NAME_TOP_2 STRING, CAMPAIGN_NAME_TOP_3 STRING, CAMPAIGN_ID_TOP_1 STRING, CAMPAIGN_ID_TOP_2 STRING, CAMPAIGN_ID_TOP_3 STRING, PORTFOLIO_NAME_TOP_1 STRING, PORTFOLIO_NAME_TOP_2 STRING, PORTFOLIO_NAME_TOP_3 STRING, PORTFOLIO_ID_TOP_1 STRING, PORTFOLIO_ID_TOP_2 STRING, PORTFOLIO_ID_TOP_3 STRING, PROFILE_NAME_TOP_1 STRING, PROFILE_NAME_TOP_2 STRING, PROFILE_NAME_TOP_3 STRING, PROFILE_ID_TOP_1 STRING, PROFILE_ID_TOP_2 STRING, PROFILE_ID_TOP_3 STRING, ADDITIONAL_INFO STRING, sku STRING)",
    "-- TASK 7 :: temp_incrementality_report_generic : DELETE FROM CLIENT_VIEW_CATALOG.temp_ccp_253.e0__temp_incrementality_report_generic WHERE (report_date BETWEEN '2025-07-13' AND '2025-07-29' AND client_id = 253 AND get_json_object(lower(additional_info), '$.retailer_id') = 31) OR report_date IS NULL OR client_id IS NULL OR additional_info IS NULL",
    "-- TASK 8 :: temp_incrementality_report_generic : INSERT INTO CLIENT_VIEW_CATALOG.temp_ccp_253.e0__temp_incrementality_report_generic SELECT CLIENT_ID, SEARCH, PLACEMENT, KEYWORD_TYPE, REPORT_DATE, CREATION_DATE, CAMPAIGN_ID, CAMPAIGN_NAME, PORTFOLIO_ID, PORTFOLIO_NAME, PROFILE_ID, PROFILE_NAME, CAMPAIGN_TYPE, TARGETING_TYPE, REPORT_TYPE, REPORT_CALCULATION_TYPE, TOTAL_SPONSORED_POSITIONS, TOTAL_SPONSORED_WEIGHT, CLIENT_SPONSORED_POSITIONS, CLIENT_SPONSORED_WEIGHT, CLIENT_ORGANIC_POSITIONS, CLIENT_ORGANIC_WEIGHT, CLICKS, IMPRESSIONS, COST, ATTRIBUTEDSALES14D, ROAS, INCREMENTAL_FRACTION, INCREMENTAL_FRACTION_BAND, INCREMENTAL_SALES, IROAS, COVERAGE, COVERAGE_TYPE, CAMPAIGN_NAME_TOP_1, CAMPAIGN_NAME_TOP_2, CAMPAIGN_NAME_TOP_3, CAMPAIGN_ID_TOP_1, CAMPAIGN_ID_TOP_2, CAMPAIGN_ID_TOP_3, PORTFOLIO_NAME_TOP_1, PORTFOLIO_NAME_TOP_2, PORTFOLIO_NAME_TOP_3, PORTFOLIO_ID_TOP_1, PORTFOLIO_ID_TOP_2, PORTFOLIO_ID_TOP_3, PROFILE_NAME_TOP_1, PROFILE_NAME_TOP_2, PROFILE_NAME_TOP_3, PROFILE_ID_TOP_1, PROFILE_ID_TOP_2, PROFILE_ID_TOP_3, to_json(named_struct('retailer_id', 31)) AS additional_info, sku FROM CLIENT_VIEW_CATALOG.temp_ccp_253.e0__incrementality_python_generic WHERE NOT client_id IS NULL AND NOT report_date IS NULL",
    "-- TASK 9 :: temp_incrementality_report_generic : INSERT INTO CLIENT_VIEW_CATALOG.temp_ccp_253.e0__temp_incrementality_report_generic SELECT CLIENT_ID, SEARCH, PLACEMENT, KEYWORD_TYPE, REPORT_DATE, CREATION_DATE, CAMPAIGN_ID, CAMPAIGN_NAME, PORTFOLIO_ID, PORTFOLIO_NAME, PROFILE_ID, PROFILE_NAME, CAMPAIGN_TYPE, TARGETING_TYPE, REPORT_TYPE, REPORT_CALCULATION_TYPE, TOTAL_SPONSORED_POSITIONS, TOTAL_SPONSORED_WEIGHT, CLIENT_SPONSORED_POSITIONS, CLIENT_SPONSORED_WEIGHT, CLIENT_ORGANIC_POSITIONS, CLIENT_ORGANIC_WEIGHT, CLICKS, IMPRESSIONS, COST, ATTRIBUTEDSALES14D, ROAS, INCREMENTAL_FRACTION, INCREMENTAL_FRACTION_BAND, INCREMENTAL_SALES, IROAS, COVERAGE, COVERAGE_TYPE, CAMPAIGN_NAME_TOP_1, CAMPAIGN_NAME_TOP_2, CAMPAIGN_NAME_TOP_3, CAMPAIGN_ID_TOP_1, CAMPAIGN_ID_TOP_2, CAMPAIGN_ID_TOP_3, PORTFOLIO_NAME_TOP_1, PORTFOLIO_NAME_TOP_2, PORTFOLIO_NAME_TOP_3, PORTFOLIO_ID_TOP_1, PORTFOLIO_ID_TOP_2, PORTFOLIO_ID_TOP_3, PROFILE_NAME_TOP_1, PROFILE_NAME_TOP_2, PROFILE_NAME_TOP_3, PROFILE_ID_TOP_1, PROFILE_ID_TOP_2, PROFILE_ID_TOP_3, to_json(named_struct('retailer_id', 31)) AS additional_info, sku FROM CLIENT_VIEW_CATALOG.temp_ccp_253.e0__sb_incrementality_report_final_generic WHERE NOT client_id IS NULL AND NOT report_date IS NULL AND report_type IN ('search', 'campaign', 'sku')",
    "-- TASK 10 :: temp_incrementality_report_generic : UPDATE CLIENT_VIEW_CATALOG.temp_ccp_253.e0__temp_incrementality_report_generic SET search = REPLACE(search, '{pipe}', '|') WHERE search LIKE '%{pipe}%'",
    "-- TASK 11 :: temp_campaign_incrementality_report_generic : DELETE FROM CLIENT_CATALOG.target_ds.campaign_incrementality_report WHERE client_id = 253 AND TO_DATE(report_date) BETWEEN '2025-07-13' AND '2025-07-29'",
    "-- TASK 12 :: temp_campaign_incrementality_report_generic : INSERT INTO CLIENT_CATALOG.target_ds.campaign_incrementality_report SELECT DISTINCT client_id, keyword_type, report_date, creation_date, campaign_id, campaign_name, portfolio_id, portfolio_name, profile_id, profile_name, campaign_type, targeting_type, report_type, report_calculation_type, clicks, impressions, cost, attributedsales14d, roas, incremental_fraction, incremental_fraction_band, incremental_sales, iroas, coverage, coverage_type, additional_info FROM CLIENT_VIEW_CATALOG.temp_ccp_253.e0__temp_incrementality_report_generic WHERE report_type = 'campaign'",
    "-- TASK 13 :: temp_search_incrementality_report_generic : DELETE FROM CLIENT_CATALOG.target_ds.search_incrementality_report WHERE client_id = 253 AND TO_DATE(report_date) BETWEEN '2025-07-13' AND '2025-07-29'",
    "-- TASK 14 :: temp_search_incrementality_report_generic : INSERT INTO CLIENT_CATALOG.target_ds.search_incrementality_report SELECT DISTINCT client_id, search, keyword_type, report_date, creation_date, campaign_type, targeting_type, report_type, report_calculation_type, total_sponsored_positions, total_sponsored_weight, client_sponsored_positions, client_sponsored_weight, client_organic_positions, client_organic_weight, clicks, impressions, cost, attributedsales14d, roas, incremental_fraction, incremental_fraction_band, incremental_sales, iroas, campaign_name_top_1, campaign_name_top_2, campaign_name_top_3, campaign_id_top_1, campaign_id_top_2, campaign_id_top_3, portfolio_name_top_1, portfolio_name_top_2, portfolio_name_top_3, portfolio_id_top_1, portfolio_id_top_2, portfolio_id_top_3, profile_name_top_1, profile_name_top_2, profile_name_top_3, profile_id_top_1, profile_id_top_2, profile_id_top_3, additional_info FROM CLIENT_VIEW_CATALOG.temp_ccp_253.e0__temp_incrementality_report_generic WHERE report_type = 'search'"
  ],
  "executionType": "TRIGGER",
  "status": "ACCEPTED"
}